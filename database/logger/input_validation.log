2025-11-05 15:42:54,451 - INFO - Processed input: "192.168.0.10"
2025-11-05 15:42:54,454 - INFO - Processed input: "http://example.com/"
2025-11-05 15:42:54,454 - INFO - Processed input: "http://internal.example.local/test"
2025-11-05 15:42:54,586 - WARNING - Resolved IP outside allowed networks
2025-11-05 15:42:54,586 - ERROR - User input error: Resolved IP not allowed
2025-11-05 15:42:54,587 - WARNING - Resolved IP outside allowed networks
2025-11-05 15:42:54,587 - ERROR - User input error: Resolved IP not allowed
2025-11-05 15:42:54,587 - ERROR - Host resolve failed: hello world!
2025-11-05 15:42:54,587 - ERROR - User input error: Unable to resolve hostname
2025-11-05 15:42:54,587 - ERROR - Host resolve failed: script alert('xss')
2025-11-05 15:42:54,587 - ERROR - User input error: Unable to resolve hostname
2025-11-05 15:42:54,588 - ERROR - Host resolve failed: 1.2.3.4  rm -rf
2025-11-05 15:42:54,588 - ERROR - User input error: Unable to resolve hostname
2025-12-11 16:29:44,765 - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2025-12-11 16:29:45,778 - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2025-12-11 16:29:45,782 - INFO - Response received from the model.
2025-12-11 16:29:45,782 - WARNING - Warning: there are non-text parts in the response: ['function_call'], returning concatenated text result from text parts. Check the full candidates.content.parts accessor to get the full model response.
2025-12-11 16:29:47,013 - INFO - HTTP Request: GET http://localhost:8000/sse "HTTP/1.1 200 OK"
2025-12-11 16:29:47,287 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=82f608f2bd2d44dbb9f2e159e7f597e3 "HTTP/1.1 202 Accepted"
2025-12-11 16:29:47,295 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=82f608f2bd2d44dbb9f2e159e7f597e3 "HTTP/1.1 202 Accepted"
2025-12-11 16:29:47,307 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=82f608f2bd2d44dbb9f2e159e7f597e3 "HTTP/1.1 202 Accepted"
2025-12-11 16:29:47,320 - INFO - 
Note: Conversion of fields that are not included in the JSONSchema class are ignored.
Json Schema is now supported natively by both Vertex AI and Gemini API. Users
are recommended to pass/receive Json Schema directly to/from the API. For example:
1. the counter part of GenerateContentConfig.response_schema is
   GenerateContentConfig.response_json_schema, which accepts [JSON
  Schema](https://json-schema.org/)
2. the counter part of FunctionDeclaration.parameters is
   FunctionDeclaration.parameters_json_schema, which accepts [JSON
   Schema](https://json-schema.org/)
3. the counter part of FunctionDeclaration.response is
   FunctionDeclaration.response_json_schema, which accepts [JSON
   Schema](https://json-schema.org/)

2025-12-11 16:29:49,001 - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2025-12-11 16:29:50,609 - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2025-12-11 16:29:50,613 - INFO - Response received from the model.
2025-12-11 16:29:50,621 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=82f608f2bd2d44dbb9f2e159e7f597e3 "HTTP/1.1 202 Accepted"
2025-12-11 16:29:52,141 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=82f608f2bd2d44dbb9f2e159e7f597e3 "HTTP/1.1 202 Accepted"
2025-12-11 16:29:53,450 - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2025-12-11 16:29:54,384 - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2025-12-11 16:29:54,386 - INFO - Response received from the model.
2025-12-11 16:29:54,393 - ERROR - an error occurred during closing of asynchronous generator <async_generator object sse_client at 0x00000233D9435010>
asyncgen: <async_generator object sse_client at 0x00000233D9435010>
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | BaseExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\mcp\client\sse.py", line 143, in sse_client
    |     yield read_stream, write_stream
    | GeneratorExit
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\mcp\client\sse.py", line 55, in sse_client
    async with anyio.create_task_group() as tg:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 789, in __aexit__
    if self.cancel_scope.__exit__(type(exc), exc, exc.__traceback__):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 461, in __exit__
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Attempted to exit cancel scope in a different task than it was entered in
2025-12-11 16:30:29,914 - INFO - Cleaning up disconnected session: session_no_headers
2025-12-11 16:30:29,916 - WARNING - Error during disconnected session cleanup: generator didn't stop after athrow()
2025-12-11 16:30:31,058 - INFO - HTTP Request: GET http://localhost:8000/sse "HTTP/1.1 200 OK"
2025-12-11 16:30:31,318 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=1f1ea013853d4c1c8f59ca596e65062e "HTTP/1.1 202 Accepted"
2025-12-11 16:30:31,323 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=1f1ea013853d4c1c8f59ca596e65062e "HTTP/1.1 202 Accepted"
2025-12-11 16:30:31,330 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=1f1ea013853d4c1c8f59ca596e65062e "HTTP/1.1 202 Accepted"
2025-12-11 16:30:32,842 - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2025-12-11 16:30:33,965 - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2025-12-11 16:30:33,968 - INFO - Response received from the model.
2025-12-11 16:30:33,973 - INFO - HTTP Request: POST http://localhost:8000/messages/?session_id=1f1ea013853d4c1c8f59ca596e65062e "HTTP/1.1 202 Accepted"
2025-12-11 16:30:35,354 - INFO - Sending out request, model: gemini-2.5-flash, backend: GoogleLLMVariant.GEMINI_API, stream: False
2025-12-11 16:30:50,558 - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2025-12-11 16:30:50,566 - INFO - Response received from the model.
2025-12-11 16:30:50,574 - ERROR - an error occurred during closing of asynchronous generator <async_generator object sse_client at 0x00000233D95E2880>
asyncgen: <async_generator object sse_client at 0x00000233D95E2880>
  + Exception Group Traceback (most recent call last):
  |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\httpx_sse\_api.py", line 75, in aconnect_sse
    |     yield EventSource(response)
    |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\mcp\client\sse.py", line 143, in sse_client
    |     yield read_stream, write_stream
    | GeneratorExit
    | 
    | During handling of the above exception, another exception occurred:
    | 
    | Traceback (most recent call last):
    |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\mcp\client\sse.py", line 61, in sse_client
    |     async with aconnect_sse(
    |                ~~~~~~~~~~~~^
    |         client,
    |         ^^^^^^^
    |         "GET",
    |         ^^^^^^
    |         url,
    |         ^^^^
    |     ) as event_source:
    |     ^
    |   File "C:\Users\alvin\anaconda3\Lib\contextlib.py", line 235, in __aexit__
    |     await self.gen.athrow(value)
    |   File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\httpx_sse\_api.py", line 74, in aconnect_sse
    |     async with client.stream(method, url, headers=headers, **kwargs) as response:
    |                ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\alvin\anaconda3\Lib\contextlib.py", line 271, in __aexit__
    |     raise RuntimeError("generator didn't stop after athrow()")
    | RuntimeError: generator didn't stop after athrow()
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\mcp\client\sse.py", line 55, in sse_client
    async with anyio.create_task_group() as tg:
               ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 789, in __aexit__
    if self.cancel_scope.__exit__(type(exc), exc, exc.__traceback__):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alvin\OneDrive\\u6587\u4ef6\VS Code Projects\Saiber\VT-SaiBER\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 461, in __exit__
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Attempted to exit cancel scope in a different task than it was entered in
