{
  "name": "vision-network-scanner",
  "version": "1.0.0",
  "description": "Safe, controlled network scanning MCP tool using the Vision Nmap backend.",
  "tools": [
    {
      "name": "ping_scan",
      "category": "reconnaissance",
      "description": "Performs a fast host discovery scan using ICMP echo, ARP, and TCP ACK probes (equivalent to `nmap -sn`). Identifies which hosts are alive without scanning any ports. Ideal for initial network mapping and least intrusive option.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": {
            "type": "string",
            "description": "Single host or network range. Supports IP, hostname, CIDR, and hyphenated ranges.",
            "examples": ["192.168.1.1", "scanme.nmap.org", "10.0.0.0/24", "192.168.0.1-254"]
          }
        },
        "required": ["target"]
      }
    },
    {
      "name": "quick_scan",
      "category": "reconnaissance",
      "description": "Scans the top 100 most common ports using aggressive timing (equivalent to `nmap -F -T4`). Provides fast visibility into common services such as HTTP, SSH, FTP, SMB, and RDP. Recommended as a general-purpose starting point.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": {
            "type": "string",
            "description": "Single IP address or hostname.",
            "examples": ["192.168.1.1", "scanme.nmap.org"]
          }
        },
        "required": ["target"]
      }
    },
    {
      "name": "port_scan",
      "category": "network_scanning",
      "description": "Runs a targeted scan of specific TCP ports or port ranges using `nmap -p`. Useful for validating exposure of known services and reducing scan time compared to broad scans.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": {
            "type": "string",
            "description": "Target IP address or hostname."
          },
          "ports": {
            "type": "string",
            "description": "Port specification: single port ('80'), list ('22,80,443'), range ('1-1000'), or mixed ('22,80-443,8000-9000').",
            "examples": ["80", "22,80,443", "1-1024", "22,80-443,8000-9000"],
            "pattern": "^[0-9,\\-]+$"
          }
        },
        "required": ["target", "ports"]
      }
    },
    {
      "name": "service_scan",
      "category": "network_scanning",
      "description": "Performs service and version detection (`nmap -sV`), probing open ports to determine software names, versions, and metadata (e.g., 'Apache httpd 2.4.41'). Essential for identifying outdated or vulnerable services.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": {
            "type": "string",
            "description": "Target host."
          },
          "ports": {
            "type": "string",
            "description": "Optional port filter to limit scanning. If omitted, Nmap scans its default top 1000 ports.",
            "pattern": "^[0-9,\\-]+$",
            "examples": ["80,443", "1-1024", "22,80,443"]
          }
        },
        "required": ["target"]
      }
    },
    {
      "name": "comprehensive_scan",
      "category": "vulnerability_assessment",
      "description": "Runs a full aggressive scan (`nmap -A -T4`). Includes OS detection, version probing, safe script scanning, and traceroute. Provides maximum detail but is the most resource-intensive and highly detectable. Recommended only for authorized assessments.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": {
            "type": "string",
            "description": "Single target host.",
            "examples": ["192.168.1.1", "prod-server.local"]
          }
        },
        "required": ["target"]
      }
    },
    {
      "name": "stealth_scan",
      "category": "network_scanning",
      "description": "Performs a TCP SYN scan (`nmap -sS`) which sends SYN packets without completing the handshake. Produces accurate results while reducing logging. Requires root/administrator permissions on most systems.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": { "type": "string" },
          "ports": {
            "type": "string",
            "description": "Optional specific ports or ranges to scan.",
            "pattern": "^[0-9,\\-]+$",
            "examples": ["80,443", "1-65535", "22,80-443"]
          }
        },
        "required": ["target"]
      }
    },
    {
      "name": "udp_scan",
      "category": "network_scanning",
      "description": "Runs a UDP scan (`nmap -sU`). Useful for discovering services such as DNS, NTP, and SNMP that operate over UDP. UDP scans can be significantly slower due to rate-limiting and lack of responses.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": { "type": "string" },
          "ports": {
            "type": "string",
            "description": "Optional UDP ports or ranges.",
            "examples": ["53", "123", "1-1024"]
          }
        },
        "required": ["target"]
      }
    },
    {
      "name": "full_tcp_scan",
      "category": "network_scanning",
      "description": "Scans all 65,535 TCP ports (`nmap -p-`). Provides complete service visibility on the target but can take significant time depending on filters, network latency, and firewalls.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": { "type": "string" }
        },
        "required": ["target"]
      }
    },
    {
      "name": "os_scan",
      "category": "reconnaissance",
      "description": "Detects the target operating system using TCP/IP fingerprinting techniques (`nmap -O`). Provides probable OS matches and accuracy scores. Less intrusive than a full comprehensive scan.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": { "type": "string" }
        },
        "required": ["target"]
      }
    },
    {
      "name": "script_scan",
      "category": "reconnaissance",
      "description": "Runs selected Nmap Scripting Engine (NSE) categories. Limited to SAFE and NON-INTRUSIVE categories only, including: default, safe, discovery, version, http-*, ssl-*, ssh-*, smb-enum*. This prevents misuse of intrusive or exploit scripts.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "target": { "type": "string" },
          "script": {
            "type": "string",
            "description": "Allowed NSE script category.",
            "enum": [
              "default",
              "safe",
              "discovery",
              "version",
              "http-*",
              "ssl-*",
              "ssh-*",
              "smb-enum*"
            ]
          }
        },
        "required": ["target"]
      }
    }
  ]
}
