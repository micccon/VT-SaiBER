┌─────────────────────────────────────────────────────────────────────────────┐
│                   VT-SaiBER Tool Access Control Matrix (Current)           │
└─────────────────────────────────────────────────────────────────────────────┘

This file documents tool naming and access policy for the MCP ToolBridge model.

Status note:
- This is the intended access policy/target model.
- Architecture direction is all-agent ReAct (non-hybrid target).
- Embedded/IoT agent has been removed from active project scope.

Naming conventions:
- MCP server native tool names: `run_exploit`, `nmap_scan`, etc.
- Bridge-exposed names to LangGraph agents:
  - `kali_<tool_name>`
  - `msf_<tool_name>`

Example:
- Native: `list_active_sessions`
- In agent toolset: `msf_list_active_sessions`


1) TOOL INVENTORY (NATIVE MCP NAMES)
═════════════════════════════════════

KALI MCP (`src/mcp/kali_mcp_server.py`):
- nmap_scan
- gobuster_scan
- dirb_scan
- nikto_scan
- sqlmap_scan
- metasploit_run
- hydra_attack
- john_crack
- wpscan_analyze
- enum4linux_scan
- server_health
- execute_command

METASPLOIT MCP (`src/mcp/msf_mcp_server.py`):
- list_exploits
- list_payloads
- generate_payload
- run_exploit
- run_post_module
- run_auxiliary_module
- list_active_sessions
- send_session_command
- list_listeners
- start_listener
- stop_job
- terminate_session


2) ACCESS POLICY MATRIX (ROLE-BASED TARGET)
════════════════════════════════════════════

Legend:
- ✅ allowed
- ⚠ conditional / approval-gated
- ❌ denied

KALI TOOLS

| Tool             | Supervisor | Scout | Fuzzer | Librarian | Striker | Resident |
|------------------|------------|-------|--------|-----------|---------|----------|
| nmap_scan        | ❌         | ✅    | ❌     | ❌        | ❌      | ❌       |
| gobuster_scan    | ❌         | ❌    | ✅     | ❌        | ❌      | ❌       |
| dirb_scan        | ❌         | ❌    | ✅     | ❌        | ❌      | ❌       |
| nikto_scan       | ❌         | ❌    | ✅     | ❌        | ❌      | ❌       |
| sqlmap_scan      | ❌         | ❌    | ⚠      | ❌        | ⚠       | ⚠        |
| execute_command  | ❌         | ❌    | ❌     | ❌        | ⚠       | ⚠        |
| hydra_attack     | ❌         | ❌    | ❌     | ❌        | ⚠       | ⚠        |
| john_crack       | ❌         | ❌    | ❌     | ❌        | ⚠       | ⚠        |
| wpscan_analyze   | ❌         | ❌    | ✅     | ❌        | ❌      | ❌       |
| enum4linux_scan  | ❌         | ✅    | ❌     | ❌        | ❌      | ❌       |
| server_health    | ❌         | ✅    | ✅     | ✅        | ✅      | ✅       |
| metasploit_run   | ❌         | ❌    | ❌     | ❌        | ❌      | ❌       |

METASPLOIT TOOLS

| Tool                  | Supervisor | Scout | Fuzzer | Librarian | Striker | Resident |
|-----------------------|------------|-------|--------|-----------|---------|----------|
| list_exploits         | ❌         | ❌    | ❌     | ✅        | ✅      | ✅       |
| list_payloads         | ❌         | ❌    | ❌     | ✅        | ⚠       | ⚠        |
| generate_payload      | ❌         | ❌    | ❌     | ❌        | ⚠       | ⚠        |
| run_exploit           | ❌         | ❌    | ❌     | ❌        | ✅      | ❌       |
| run_auxiliary_module  | ❌         | ❌    | ❌     | ❌        | ✅      | ❌       |
| run_post_module       | ❌         | ❌    | ❌     | ❌        | ❌      | ✅       |
| list_active_sessions  | ❌         | ❌    | ❌     | ❌        | ✅      | ✅       |
| send_session_command  | ❌         | ❌    | ❌     | ❌        | ❌      | ✅       |
| list_listeners        | ❌         | ❌    | ❌     | ❌        | ⚠       | ✅       |
| start_listener        | ❌         | ❌    | ❌     | ❌        | ⚠       | ✅       |
| stop_job              | ❌         | ❌    | ❌     | ❌        | ❌      | ✅       |
| terminate_session     | ❌         | ❌    | ❌     | ❌        | ❌      | ✅       |


3) REACT ALLOWLIST PATTERN
══════════════════════════

Bridge filtering implementation:
- `src/mcp/mcp_tool_bridge.py`

Example ReAct tool allowlists:
- `src/agents/striker.py`
  - `list_exploits`
  - `run_exploit`
  - `run_auxiliary_module`
  - `list_active_sessions`
- `src/agents/resident.py`
  - `list_active_sessions`
  - `send_session_command`
  - `run_post_module`
  - `list_exploits`
  - `terminate_session`

All agents should follow this same allowlist pattern through MCP ToolBridge.


4) HOW TO READ TOOL NAMES IN AGENT CODE
═══════════════════════════════════════

Allowlist can be written using native names:
- `run_exploit`

At runtime, actual registered tool names are prefixed:
- `msf_run_exploit`

Both forms are accepted by bridge filtering.
