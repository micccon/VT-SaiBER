LEGACY DIAGRAM NOTICE (Updated Feb 2026):
- This diagram contains historical/static-client references and may not match current MCP ToolBridge behavior.
- Automotive/Embedded agent and MCP blocks shown below are legacy references and are not active scope.
- Canonical docs for current architecture are:
  - docs/ARCHITECTURE.md
  - docs/MCP.md
  - docs/visuals/mcp.txt
  - docs/visuals/execution_example.txt

┌─────────────────────────────────────────────────────────────────────────────┐
│                           VT-SaiBER System Architecture                      │
└─────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────────┐
                              │   User/Operator  │
                              │  (Mission Start) │
                              └────────┬─────────┘
                                       │
                                       ▼
┌──────────────────────────────────────────────────────────────────────────────┐
│                        Python Agent Layer (src/)                             │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │                     LangGraph Orchestration                            │  │ 
│  │                                                                        │  │
│  │  ┌──────────┐   ┌────────┐   ┌────────┐   ┌──────────┐   ┌─────────┐   │  │
│  │  │Supervisor│◄─►│ Scout  │◄─►│ Fuzzer │◄─►│ Striker  │◄─►│Resident │   │  │
│  │  │ (Router) │   │ (Recon)│   │  (Web) │   │(Exploit) │   │ (Post)  │   │  │
│  │  └────┬─────┘   └───┬────┘   └───┬────┘   └────┬─────┘   └────┬────┘   │  │
│  │       │             │            │             │              │        │  │
│  │  ┌────┴─────┐   ┌───┴────────────┴─────────────┴──────────────┴────┐   │  │
│  │  │Librarian │   │         Automotive (OT Specialist)               │   │  │
│  │  │  (RAG/   │   │         (CAN Bus / ICSim)                        │   │  │
│  │  │  OSINT)  │   │                                                  │   │  │
│  │  └────┬─────┘   └──────────────────────────────────────────────────┘   │  │
│  │       │                                                                │  │
│  └───────┼────────────────────────────────────────────────────────────────┘  │
│          │                                                                   │
│  ┌───────┴────────────────────────────────────────────────────────────┐      │
│  │                      CyberState (TypedDict)                        │      │
│  │  - mission_goal          - discovered_targets                      │      │
│  │  - target_scope          - web_findings                            │      │
│  │  - iteration_count       - active_sessions                         │      │
│  │  - mission_status        - agent_log                               │      │
│  │  - critical_findings     - errors                                  │      │
│  └───────┬────────────────────────────────────────────────────────────┘      │
│          │                                                                   │
│  ┌───────┴────────────────────────────────────────────────────────────┐      │
│  │                      MCP Client (Router)                           │      │
│  │            Routes tool calls to appropriate servers                │      │
│  └────┬────────────────────────────────┬──────────────────────┬───────┘      │
└───────┼────────────────────────────────┼──────────────────────┼──────────────┘
        │                                │                      │
        ▼                                ▼                      ▼
┌───────────────┐              ┌─────────────────┐    ┌──────────────────┐
│  Kali MCP     │              │ Metasploit MCP  │    │ Automotive MCP   │
│  Server       │              │   Server        │    │   Server         │
│  (Docker)     │              │   (Docker)      │    │   (Docker)       │
│               │              │                 │    │                  │
│ - nmap        │              │ - search_modules│    │ - candump        │
│ - gobuster    │              │ - run_exploit   │    │ - cansend        │
│ - ffuf        │              │ - sessions      │    │ - uds_scan       │
│ - nikto       │              │ - meterpreter   │    │                  │
└───────┬───────┘              └────────┬────────┘    └────────┬─────────┘
        │                               │                      │
        │                               │                      │
        └───────────────┬───────────────┴──────────────────────┘
                        ▼
                ┌───────────────┐
                │  Target VMs   │
                │               │
                │ - Metasploitable2       (IT Target)
                │ - Custom Linux VM       (IT Target)
                │ - ICSim (Automotive)    (OT Target)
                └───────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                    PostgreSQL Database (Persistence)                         │
│                                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐  ┌─────────────────┐    │
│  │   targets    │  │   services   │  │  findings   │  │   sessions      │    │
│  │  (IPs/hosts) │  │  (ports/ver) │  │ (vulns/etc) │  │  (exploits)     │    │
│  └──────────────┘  └──────────────┘  └─────────────┘  └─────────────────┘    │
│                                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐  ┌─────────────────┐    │
│  │  agent_log   │  │ checkpoints  │  │knowledge_base│ │  (optional)     │    │
│  │ (decisions)  │  │ (LangGraph)  │  │ (RAG vectors)│ │ attack_chain    │    │
│  └──────────────┘  └──────────────┘  └─────────────┘  └─────────────────┘    │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│                        Observability & Monitoring                            │
│                                                                              │
│  ┌──────────────┐              ┌─────────────────┐                           │
│  │  LangSmith   │              │  Logging/       │                           │
│  │  (Tracing)   │              │  Metrics        │                           │
│  └──────────────┘              └─────────────────┘                           │
└──────────────────────────────────────────────────────────────────────────────┘

NOTES:
- Agents follow logical pentesting progression (inspired by MITRE workflow)
- Supervisor uses AI reasoning, not hardcoded MITRE rules
- Optional: Post-mission analysis can map actions to MITRE framework
